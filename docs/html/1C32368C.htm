<!DOCTYPE html ><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><link rel="stylesheet" href="../css/vs.min.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/highlight.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>SystemPerformanceOptimizationContext Class</title><meta name="Title" content="SystemPerformanceOptimizationContext" /><meta name="Help.Id" content="T:Novacta.Analytics.Advanced.SystemPerformanceOptimizationContext" /><meta name="Help.ContentType" content="Reference" /><meta name="container" content="Novacta.Analytics.Advanced" /><meta name="guid" content="1C32368C" /><meta name="Description" content="Represents a Cross-Entropy context in which the optimization of the performance of a system is obtained by exploiting a instance." /><meta name="tocFile" content="../toc/IDBE.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><img src="../icons/Help.png" /></div><div id="DocumentationTitle" class="level-item">Novacta.Analytics Documentation</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a><a class="dropdown-item languageFilterItem" data-languageId="vb">VB</a><a class="dropdown-item languageFilterItem" data-languageId="cpp">C++</a><a class="dropdown-item languageFilterItem" data-languageId="fs">F#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div id="ContentContainer" class="columns pl-5 pr-5 fixedContent"><div id="ShowHideTOCColumn" class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="Resizer" class="is-hidden"></div><div id="TopicContent" class="column content is-7"><h1>System<wbr />Performance<wbr />Optimization<wbr />Context Class</h1><div class="summary">
             Represents a Cross-Entropy context in which the 
             optimization of the performance of a system
             is obtained by exploiting 
             a <a href="E252E84.htm">SystemPerformanceOptimizer</a> instance.
             </div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Definition</h2><div id="IDBSection"><strong>Namespace:</strong> <a href="F249DE1E.htm">Novacta.Analytics.Advanced</a><br /><strong>Assembly:</strong> Novacta.Analytics (in Novacta.Analytics.dll) Version: 2.1.0+428f3840cfab98dda567bb0ed350b302533e273a<div class="codeSnippet" data-codeSnippetLanguage="cs"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="identifier">SystemPerformanceOptimizationContext</span> : <span class="identifier">CrossEntropyContext</span></code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="vb"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vb"><span class="keyword">Public</span> <span class="keyword">MustInherit</span> <span class="keyword">Class</span> <span class="identifier">SystemPerformanceOptimizationContext</span>
	<span class="keyword">Inherits</span> <span class="identifier">CrossEntropyContext</span></code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="cpp"><div class="codeHeader"><span class="codeHeaderTitle">C++</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cpp"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">SystemPerformanceOptimizationContext</span> <span class="keyword">abstract</span> : <span class="keyword">public</span> <span class="identifier">CrossEntropyContext</span></code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="fs"><div class="codeHeader"><span class="codeHeaderTitle">F#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-fs">[&lt;<span class="identifier">AbstractClassAttribute</span>&gt;]
<span class="keyword">type</span> <span class="identifier">SystemPerformanceOptimizationContext</span> = 
    <span class="keyword">class</span>
        <span class="keyword">inherit</span> <span class="identifier">CrossEntropyContext</span>
    <span class="keyword">end</span></code></pre></div></div><dl class="inheritanceHierarchy"><dt>Inheritance</dt><dd><a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>  <span class="icon is-small"><i class="fa fa-arrow-right"></i></span>  <a href="F04A1B18.htm">CrossEntropyContext</a>  <span class="icon is-small"><i class="fa fa-arrow-right"></i></span>  <span class="selflink">SystemPerformanceOptimizationContext</span></dd></dl><dl class="inheritanceHierarchy"><dt>Derived</dt><dd><div><a href="EB7894F3.htm">Novacta.Analytics.Advanced<span id="LST1C32368C_0" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>CategoricalEntailmentEnsembleOptimizationContext</a></div><div><a href="236BBBCF.htm">Novacta.Analytics.Advanced<span id="LST1C32368C_1" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>CombinationOptimizationContext</a></div><div><a href="A8203153.htm">Novacta.Analytics.Advanced<span id="LST1C32368C_2" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>ContinuousOptimizationContext</a></div><div><a href="240B10D.htm">Novacta.Analytics.Advanced<span id="LST1C32368C_3" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>PartitionOptimizationContext</a></div></dd></dl></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Remarks</h2><div id="IDBCSection"><p>
             A <a href="E252E84.htm">SystemPerformanceOptimizer</a> is executed by calling its 
             <a href="E8269C07.htm">Optimize</a> 
             method. This is a 
             template method, in the sense that it defines the 
             invariant parts of a Cross-Entropy program for system's performance
             optimization.
             Such method relies on an instance of 
             class <span class="selflink">SystemPerformanceOptimizationContext</span>, which is 
             passed as a parameter to it and specifies the 
             <em>primitive operations</em> 
             of the template method, i.e. 
             those varying steps of the algorithm that depends 
             on the problem under study.
             </p><p>
             Class <span class="selflink">SystemPerformanceOptimizationContext</span> thoroughly 
             defines the system whose performance must be optimized, and supplies the 
             primitive operations as abstract or virtual methods, that its 
             subclasses will override to provide the concrete 
             behavior of the optimizer.
             </p><p>
             A Cross-Entropy optimizer is designed to identify the 
             optimal arguments at which the performance function of a
             complex system reaches
             its minimum or maximum value.
             To get the optimal state, the system's state-space 
             <img alt="LaTeX equation" src="../media/latex_9777.svg" /> is traversed iteratively 
             by sampling, at each iteration, from 
             a specific density function, member of a parametric 
             family  
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9778.svg" /><br /><br />
             where <img alt="LaTeX equation" src="../media/latex_9779.svg" style="vertical-align: -1px" /> is a 
             vector representing 
             a possible state of the system, 
             and <img alt="LaTeX equation" src="../media/latex_9780.svg" style="vertical-align: -1px" /> is the set of 
             allowable values for parameter <img alt="LaTeX equation" src="../media/latex_9781.svg" />.
             The parameter exploited at a given iteration <img alt="LaTeX equation" src="../media/latex_9782.svg" />
             is referred to
             as the <i>reference</i> parameter of such iteration and indicated
             as <img alt="LaTeX equation" src="../media/latex_9783.svg" style="vertical-align: -2px" />.
             A minimum number
             of iterations, say <img alt="LaTeX equation" src="../media/latex_9784.svg" />, must be executed, while a 
             number of them up to a maximum, say <img alt="LaTeX equation" src="../media/latex_9785.svg" />, is allowed.
             </p><p>
             The parametric space <img alt="LaTeX equation" src="../media/latex_9786.svg" style="vertical-align: -1px" /> should 
             include a parameter under which all possible states must have 
             a real chance of being selected: this parameter
             must be specified as the initial <i>reference</i> parameter
             <img alt="LaTeX equation" src="../media/latex_9787.svg" style="vertical-align: -2px" />.
             </p><p>
             A Cross-Entropy optimizer can solve one of the 
             following optimization programs:
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9788.svg" /><br /><br />
             where <img alt="LaTeX equation" src="../media/latex_9789.svg" /> is the state space 
             of the system and 
             <img alt="LaTeX equation" src="../media/latex_9790.svg" style="vertical-align: -4px" /> is the function 
             returning the system performance at state  
             <img alt="LaTeX equation" src="../media/latex_9791.svg" />.
             </p><p>
             At instantiation, the constructor of 
             a <span class="selflink">SystemPerformanceOptimizationContext</span> object
             will receive information about the optimization under study by
             means of parameters representing <img alt="LaTeX equation" src="../media/latex_9792.svg" style="vertical-align: -2px" />,
             <img alt="LaTeX equation" src="../media/latex_9793.svg" />, <img alt="LaTeX equation" src="../media/latex_9794.svg" />, and a constant stating 
             if the optimization goal is a maximization or a minimization.
             </p><p>
             After construction, property 
             <a href="1FE43CBC.htm">InitialParameter</a> represents 
             <img alt="LaTeX equation" src="../media/latex_9795.svg" style="vertical-align: -2px" />, while <img alt="LaTeX equation" src="../media/latex_9796.svg" />
             and <img alt="LaTeX equation" src="../media/latex_9797.svg" />
             can be inspected, respectively, via properties
             <a href="44E3AF08.htm">MinimumNumberOfIterations</a> and
             <a href="CB60FB7E.htm">MaximumNumberOfIterations</a>. Lastly, 
             property 
             <a href="847A8F0F.htm">OptimizationGoal</a> 
             signals that the performance function
             must be maximized if it 
             evaluates to the constant <a href="D5F83433.htm">Maximization</a>, or 
             that a minimization is requested
             if it evaluates to
             the constant <a href="D5F83433.htm">Minimization</a>.
             </p><p><b>Implementing a context for combinatorial 
             and multi-extremal optimization</b></p><p>
             The Cross-Entropy method 
             provides an iterative multi step procedure. At each 
             iteration <img alt="LaTeX equation" src="../media/latex_9798.svg" />, the <i>sampling step</i>
             is executed in order to generate diverse candidate states of 
             the system, sampled from a distribution 
             characterized by the <i>reference parameter</i> of the iteration,
             say <img alt="LaTeX equation" src="../media/latex_9799.svg" style="vertical-align: -2px" />. 
             Such sample is thus exploited in the <i>updating step</i> as follows.
             Firstly, an extreme level 
             <img alt="LaTeX equation" src="../media/latex_9800.svg" style="vertical-align: -2px" /> is computed to define 
             the <i>elite</i> sampled points, i.e. those points
             having the lowest performances (less than <img alt="LaTeX equation" src="../media/latex_9801.svg" style="vertical-align: -2px" />)
             in case of a minimization,
             or the highest ones in case of a maximization (greater than
             <img alt="LaTeX equation" src="../media/latex_9802.svg" style="vertical-align: -2px" />).
             Secondly, a new <i>reference</i> 
             parameter <img alt="LaTeX equation" src="../media/latex_9803.svg" style="vertical-align: -2px" /> is 
             identified to modify the distribution from which the samples 
             will be obtained in the next iteration: such modification is
             based on the <i>elite</i> sample points only, in order to improve 
             the probability of sampling relevant states, i.e. those 
             states corresponding to the performance excesses of interest
             (See the documentation of 
             class <a href="298402DD.htm">CrossEntropyProgram</a> for a 
             thorough discussion of the Cross-Entropy method). 
             </p><p>
             When the Cross-Entropy method is applied in an optimization
             context, a final <i>optimizing step</i> is executed, in which  
             the argument corresponding to the searched extremum  
             is effectively identified.
             </p><p>These steps must be implemented as follows.</p><p><b><i>Sampling step</i></b></p><p>
             Since class <span class="selflink">SystemPerformanceOptimizationContext</span> derives 
             from <a href="F04A1B18.htm">CrossEntropyContext</a>,  
             property <a href="6BFCB280.htm">StateDimension</a> 
             will return the dimension of the points in the Cross-Entropy samples.  
             If a state <img alt="LaTeX equation" src="../media/latex_9804.svg" /> of the system 
             can be represented as a vector of length 
             <img alt="LaTeX equation" src="../media/latex_9805.svg" />, as in 
             <img alt="LaTeX equation" src="../media/latex_9806.svg" style="vertical-align: -4px" />, then 
             <img alt="LaTeX equation" src="../media/latex_9807.svg" /> should be returned.
             In addition, method <a href="6D600898.htm">PartialSample(<span id="LST1C32368C_4" data-languageSpecificText="cpp=array&lt;"></span>Double<span id="LST1C32368C_5" data-languageSpecificText="cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]"></span>, Tuple<span id="LST1C32368C_6" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>Int32, Int32<span id="LST1C32368C_7" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>, RandomNumberGenerator, DoubleMatrix, Int32)</a> 
             must be overriden to determine how to draw the sample locally 
             to a given thread when processing in parallel the sampling step.
             </p><p><b><i>Updating step</i></b></p><p>
             Class <span class="selflink">SystemPerformanceOptimizationContext</span> overrides 
             for you the methods 
             required for ordering the system performances of the states sampled 
             in the previous step, for updating the 
             iteration levels and identifying the corresponding elite sample points.
             However, to complete the implementation of the <i>updating step</i>, 
             function <img alt="LaTeX equation" src="../media/latex_9808.svg" /> must be defined via 
             method <a href="1AF89526.htm">Performance(DoubleMatrix)</a>,
             and method <a href="4AE2243.htm">UpdateParameter(LinkedList<span id="LST1C32368C_8" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>DoubleMatrix<span id="LST1C32368C_9" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>, DoubleMatrix)</a> 
             also needs to be overridden. 
             Given <img alt="LaTeX equation" src="../media/latex_9809.svg" style="vertical-align: -2px" /> and 
             <img alt="LaTeX equation" src="../media/latex_9810.svg" style="vertical-align: -2px" />, this method is expected to return 
             the solution to the following program:
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9811.svg" /><br /><br />
             where 
             <img alt="LaTeX equation" src="../media/latex_9812.svg" style="vertical-align: -4px" /> is the set 
             of elite sample positions (row indexes of the matrix returned 
             by method <a href="CD524A5D.htm">Sample</a>, with 
             <img alt="LaTeX equation" src="../media/latex_9813.svg" style="vertical-align: -5px" /> being the <img alt="LaTeX equation" src="../media/latex_9814.svg" />-th row of such matrix
             and <img alt="LaTeX equation" src="../media/latex_9815.svg" /> being its number of rows.
             Method <a href="4AE2243.htm">UpdateParameter</a> 
             receives two parameters. The first is a <a href="https://learn.microsoft.com/dotnet/api/system.collections.generic.linkedlist-1" target="_blank" rel="noopener noreferrer">LinkedList<span id="LST1C32368C_10" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>T<span id="LST1C32368C_11" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a> 
             of <a href="1DED9EB1.htm">DoubleMatrix</a> instances, 
             representing the <em>reference</em> parameters applied in previous 
             iterations. The instance 
             returned by property <a href="https://learn.microsoft.com/dotnet/api/system.collections.generic.linkedlist-1.last" target="_blank" rel="noopener noreferrer">Last</a> corresponds to 
             parameter <img alt="LaTeX equation" src="../media/latex_9816.svg" style="vertical-align: -2px" />. The second method parameter is 
             a <a href="1DED9EB1.htm">DoubleMatrix</a> instance whose rows represent the elite points
             sampled in the current iteration.
             </p><p><b><i>Optimizing step</i></b></p><p>
             The optimizing step is executed after that the underlying 
             Cross-Entropy program 
             has converged. 
             In a specified context, it is expected that, 
             given a reference parameter 
             <img alt="LaTeX equation" src="../media/latex_9817.svg" />, a corresponding reasonable value could be 
             guessed for the optimizing argument of <img alt="LaTeX equation" src="../media/latex_9818.svg" />, 
             say <img alt="LaTeX equation" src="../media/latex_9819.svg" style="vertical-align: -4px" />, with <img alt="LaTeX equation" src="../media/latex_9820.svg" /> a function
             from <img alt="LaTeX equation" src="../media/latex_9821.svg" style="vertical-align: -1px" /> to <img alt="LaTeX equation" src="../media/latex_9822.svg" />. 
             Function <img alt="LaTeX equation" src="../media/latex_9823.svg" /> must be defined by overriding method 
             <a href="9B360782.htm">GetOptimalState(DoubleMatrix)</a> 
             that should return <img alt="LaTeX equation" src="../media/latex_9824.svg" style="vertical-align: -4px" />
             given a specific reference parameter <img alt="LaTeX equation" src="../media/latex_9825.svg" />.
             </p><p>
             Given the optimal parameter <img alt="LaTeX equation" src="../media/latex_9826.svg" style="vertical-align: -2px" />, 
             (the parameter corresponding to the last iteration 
             <img alt="LaTeX equation" src="../media/latex_9827.svg" /> executed by the algorithm before stopping), 
             the argument at which the searched extremum is considered 
             as reached according to the Cross-Entropy method will be
             returned as <img alt="LaTeX equation" src="../media/latex_9828.svg" style="vertical-align: -4px" />.
             </p><p><b><i>Additional overridable methods</i></b></p><p><i>Applying a smoothing scheme to parameters</i></p><p>
             Especially when a sampling parameter consists of probabilities, a
             <a href="E252E84.htm">SystemPerformanceOptimizer</a> could converge to a 
             wrong solution
             if such parameter is updated without applying a smoothing scheme,
             so preventing the probabilities to reach 
             <img alt="LaTeX equation" src="../media/latex_9829.svg" /> or <img alt="LaTeX equation" src="../media/latex_9830.svg" /> values
             too quickly, in the early iterations of the program.
             </p><p>
             Let <img alt="LaTeX equation" src="../media/latex_9831.svg" style="vertical-align: -2px" /> the reference parameter 
             exploited in the last iteration, 
             and let <img alt="LaTeX equation" src="../media/latex_9832.svg" style="vertical-align: -2px" /> the previous one.
             By default, this method 
             applies the following smoothing scheme:
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9833.svg" /><br /><br />
             where <img alt="LaTeX equation" src="../media/latex_9834.svg" />.
             </p><p>
             You can override 
             method <a href="DB205520.htm">SmoothParameter(LinkedList<span id="LST1C32368C_12" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>DoubleMatrix<span id="LST1C32368C_13" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>)</a>
             in order to apply a smoothing scheme specific to
             a given context.
             </p><p><i>Stopping criterion</i></p><p>
             An iteration is defined as intermediate
             for a <span class="selflink">SystemPerformanceOptimizationContext</span> if it is 
             greater than <a href="44E3AF08.htm">MinimumNumberOfIterations</a>, and
             less than <a href="CB60FB7E.htm">MaximumNumberOfIterations</a>.
             </p><p>
             For intermediate iterations, method <a href="F068CBEA.htm">StopAtIntermediateIteration(Int32, LinkedList<span id="LST1C32368C_14" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>Double<span id="LST1C32368C_15" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>, LinkedList<span id="LST1C32368C_16" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>DoubleMatrix<span id="LST1C32368C_17" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>)</a> is
             called to check if a Cross-Entropy program executing in this
             context should stop or not.
             </p><p>
             By default, the method controls if, in the last 
             <a href="44E3AF08.htm">MinimumNumberOfIterations</a> iterations, the 
             levels achieved by the program remain constant, and, if so,
             return <span class="code">true</span>; otherwise returns <span class="code">false</span>.
             </p><p>
             You can override <a href="F068CBEA.htm">
             StopAtIntermediateIteration</a> in order to apply a specific 
             stopping criterion for intermediate iterations.
             </p></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Example</h2><div id="IDCCSection"><p>
             The following example is based on Section 5.1 
             proposed by Rubinstein and Kroese 
             (Section 2.2.1)<sup class="citation"><a href="#cite1">[1]</a></sup>.
             </p><p>
             A Cross-Entropy optimizer is exploited 
             to minimize the bi-dimensional Rosenbrock function,
             showed in the following figure.
            </p><p>100%Bi-dimensional Rosenbrock functionOptimizationExample.png</p><p>
             The global minimum at <img alt="LaTeX equation" src="../media/latex_9835.svg" style="vertical-align: -4px" />
             is indicated by a red dot.
             </p><p>
             In order to solve such problem, we define a Cross-Entropy context 
             as follows. 
             Since the function under study has two arguments, we analyze a
             system whose generic state
             <img alt="LaTeX equation" src="../media/latex_9836.svg" /> can be represented as a 
             vector of length 2:
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9837.svg" /><br /><br />    
             while the Rosenbrock function is interpreted as the performance 
             of the system, i.e. 
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9838.svg" /><br /><br /></p><p>
             The sampling step is accomplished as follows.
             Each component <img alt="LaTeX equation" src="../media/latex_9839.svg" style="vertical-align: -5px" /> of a state
             <img alt="LaTeX equation" src="../media/latex_9840.svg" style="vertical-align: -4px" /> is attached to a 
             Gaussian distribution, say <img alt="LaTeX equation" src="../media/latex_9841.svg" style="vertical-align: -6px" />,
             and 
             the <i>j</i>-th entry 
             of a state is sampled from <img alt="LaTeX equation" src="../media/latex_9842.svg" style="vertical-align: -6px" />, 
             independently from the other. 
             The Cross-Entropy sampling parameter can thus be 
             represented as a <img alt="LaTeX equation" src="../media/latex_9843.svg" /> matrix <img alt="LaTeX equation" src="../media/latex_9844.svg" />,
             whose first row stores the means of the Gaussian 
             distributions, while the second row contains their standard
             deviations, so that <img alt="LaTeX equation" src="../media/latex_9845.svg" style="vertical-align: -5px" /> and
             <img alt="LaTeX equation" src="../media/latex_9846.svg" style="vertical-align: -5px" />.
             </p><p>
             The initial parameter sets (arbitrarily) the Gaussian 
             means to <img alt="LaTeX equation" src="../media/latex_9847.svg" />.
             More importantly, the standard deviations are set equal
             to <img alt="LaTeX equation" src="../media/latex_9848.svg" />: in this way, during the first
             execution of the sampling
             step each argument will have a good likelihood 
             of being drawn.
             </p><p>
             At iteration <img alt="LaTeX equation" src="../media/latex_9849.svg" />, the parameter's first 
             row updating formula is, 
             for <img alt="LaTeX equation" src="../media/latex_9850.svg" style="vertical-align: -4px" />,
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9851.svg" /><br /><br />
             where <img alt="LaTeX equation" src="../media/latex_9852.svg" style="vertical-align: -4px" />
             is the set of elite sample in this context, i.e. the set of sample
             points having the lowest performances observed during the <img alt="LaTeX equation" src="../media/latex_9853.svg" />-th
             iteration.
             The parameter's second row, that containing the standard deviations, 
             is instead updated as follows:
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9854.svg" /><br /><br /></p><p>
             The so-updated parameter is thus smoothed applying the following formulas
             (See Rubinstein and Kroese, 
             Remark 5.2, p. 189<sup class="citation"><a href="#cite1">[1]</a></sup>.):
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9855.svg" /><br /><br />
             where <img alt="LaTeX equation" src="../media/latex_9856.svg" style="vertical-align: -2px" />, and
             <br /><br /><img alt="LaTeX equation" src="../media/latex_9857.svg" /><br /><br />
             with <img alt="LaTeX equation" src="../media/latex_9858.svg" style="vertical-align: -4px" /> and <img alt="LaTeX equation" src="../media/latex_9859.svg" style="vertical-align: -4px" />.
             </p><p>
             The algorithm will stop if each standard deviation in a Cross-Entropy
             parameter will be less than <img alt="LaTeX equation" src="../media/latex_9860.svg" />.
             </p><p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">Minimizing the bi-dimensional Rosenbrock function.</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">using System;
using System.Collections.Generic;
using Novacta.Analytics.Advanced;

namespace Novacta.Analytics.CodeExamples.Advanced
{
    public class CrossEntropyOptimizerExample0  
    {
        class RosenbrockFunctionMinimizationContext
            : SystemPerformanceOptimizationContext
        {
            public RosenbrockFunctionMinimizationContext()
                : base(
                    // The function to be optimized is the bi-dimensional
                    // Rosenbrock function, hence it has two arguments.
                    // Thus it can be interpreted as the performance of
                    // a system whose state can be represented as a vector
                    // of length 2.
                    stateDimension: 2,
                    // Set the optimization goal to minimization.
                    optimizationGoal: OptimizationGoal.Minimization,
                    // Define the initial parameter of the distribution
                    // from which samples are drawn while searching
                    // for the optimizer (sampling the state-space
                    // of the system, i.e. the domain of the function).
                    // The parameter is a matrix of two rows.
                    // Its first row represents the means, its second one 
                    // the standard deviations of two Gaussian distributions
                    // from which the two arguments of the optimizing function,
                    // respectively, are sampled while searching 
                    // for the optimizer.
                    initialParameter: DoubleMatrix.Dense(2, 2,
                        [-1.0, 10000.0, -1.0, 10000.0]),
                    minimumNumberOfIterations: 3,
                    maximumNumberOfIterations: 10000)
            {
            }

            // Define the performance function of the 
            // system under study (in this context, 
            // a bi-dimensional Rosenbrock function to be minimized).
            protected override double Performance(DoubleMatrix x)
            {
                double performance = 0.0;
                for (int i = 0; i &lt; this.StateDimension - 1; i++)
                {
                    var x_i = x[i];
                    var squared_x_i = Math.Pow(x[i], 2.0);
                    performance += 100.0 * (Math.Pow(x[i + 1] - squared_x_i, 2.0));
                    performance += Math.Pow(1.0 - x_i, 2.0);
                }
                return performance;
            }

            // Set how to sample system states
            // given the specified parameter. 
            protected override void PartialSample(
                double[] destinationArray,
                Tuple&lt;int, int&gt; sampleSubsetRange,
                RandomNumberGenerator randomNumberGenerator,
                DoubleMatrix parameter,
                int sampleSize)
            {
                // Must be Item1 included, Item2 excluded
                int subSampleSize =
                    sampleSubsetRange.Item2 - sampleSubsetRange.Item1;

                int leadingDimension = Convert.ToInt32(sampleSize);

                for (int j = 0; j &lt; this.StateDimension; j++)
                {
                    var distribution = new
                        GaussianDistribution(
                            mu: parameter[0, j],
                            sigma: parameter[1, j])
                    {
                        RandomNumberGenerator = randomNumberGenerator
                    };
                    distribution.Sample(
                         subSampleSize,
                         destinationArray, j * leadingDimension + sampleSubsetRange.Item1);
                }
            }

            // Define how to get the optimal state given
            // a Cross-Entropy parameter.
            protected override DoubleMatrix GetOptimalState(
                DoubleMatrix parameter)
            {
                // The optimal state is the vector of
                // means.
                return parameter[0, ":"];
            }

            // Set how to update the parameter via 
            // the elite sample.
            protected override DoubleMatrix UpdateParameter(
                LinkedList&lt;DoubleMatrix&gt; parameters,
                DoubleMatrix eliteSample)
            {
                var newParameter = DoubleMatrix.Dense(2, this.StateDimension);
                newParameter[0, ":"] =
                    Stat.Mean(
                        data: eliteSample,
                        dataOperation: DataOperation.OnColumns);
                newParameter[1, ":"] =
                    Stat.StandardDeviation(
                        data: eliteSample,
                        dataOperation: DataOperation.OnColumns,
                        adjustForBias: false);

                return newParameter;
            }

            // Provide a smoothing scheme for updated sampling
            // parameters.
            protected override void SmoothParameter(
                LinkedList&lt;DoubleMatrix&gt; parameters)
            {
                double iteration = Convert.ToDouble(parameters.Count);
                if (iteration &gt; 1)
                {
                    DoubleMatrix currentParameter = parameters.Last.Value;
                    DoubleMatrix previousParameter = parameters.Last.Previous.Value;

                    // Smoothing means
                    double meanAlpha = .7;
                    var previousMeans = previousParameter[0, ":"];
                    var currentMeans = currentParameter[0, ":"];
                    currentParameter[0, ":"] =
                        meanAlpha * currentMeans + (1.0 - meanAlpha) * previousMeans;

                    // Smoothing standard deviations
                    var previousStdDevs = previousParameter[1, ":"];
                    var currentStdDevs = currentParameter[1, ":"];
                    double q = 6.0;
                    double beta = .9;
                    double stdDevAlpha = beta * (1.0 - Math.Pow(1.0 - 1.0 / iteration, q));

                    currentParameter[1, ":"] =
                        stdDevAlpha * currentStdDevs + (1.0 - stdDevAlpha) * previousStdDevs;
                }
            }

            protected override bool StopAtIntermediateIteration(
                int iteration,
                LinkedList&lt;double&gt; levels,
                LinkedList&lt;DoubleMatrix&gt; parameters)
            {
                // Stop the program when each 
                // standard deviation is less than .05.
                var stdDevs = parameters.Last.Value[1, ":"];
                for (int j = 0; j &lt; stdDevs.Count; j++)
                {
                    if (stdDevs[j] &gt;= .05)
                    {
                        return false;
                    }
                }

                return true;
            }
        }

        public void Main()
        {
            // Create the context.
            var context = new RosenbrockFunctionMinimizationContext();

            // Create the optimizer.
            var optimizer = new SystemPerformanceOptimizer()
            {
                PerformanceEvaluationParallelOptions = { MaxDegreeOfParallelism = -1 },
                SampleGenerationParallelOptions = { MaxDegreeOfParallelism = -1 }
            };

            // Set optimization parameters.
            double rarity = 0.1;
            int sampleSize = 1000;

            // Solve the problem.
            var results = optimizer.Optimize(
                context,
                rarity,
                sampleSize);

            // Show the results.
            Console.WriteLine(
                "The Cross-Entropy optimizer has converged: {0}.",
                results.HasConverged);

            Console.WriteLine();
            Console.WriteLine("Initial guess parameter:");
            Console.WriteLine(context.InitialParameter);

            Console.WriteLine();
            Console.WriteLine("The minimizer of the performance is:");
            Console.WriteLine(results.OptimalState);

            Console.WriteLine();

            Console.WriteLine("The minimum performance is:");
            Console.WriteLine(results.OptimalPerformance);
        }
    }
}

// Executing method Main() produces the following output:
// 
// The Cross-Entropy optimizer has converged: True.
// 
// Initial guess parameter:
// -1               -1               
// 10000            10000            
// 
// 
// 
// The minimizer of the performance is:
// 1.00035159       1.00074794       
// 
// 
// 
// The minimum performance is:
// 3.229304809674981E-07</code></pre></div></div></p></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Constructors</h2><div id="IDDEASection"><table id="ConstructorList" class="table is-hoverable"><tr><td><a href="25271985.htm">SystemPerformanceOptimizationContext</a></td><td>
            Initializes a new instance of the 
            <span class="selflink">SystemPerformanceOptimizationContext</span> class 
            having the specified state dimension, initial parameter, 
            optimization goal, and range of iterations.
            </td></tr></table></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Properties</h2><div id="IDQEASection"><table id="PropertyList" class="table is-hoverable"><tr><td><a href="66F284A1.htm">EliteSampleDefinition</a></td><td>
            Gets the elite sample definition for this context.
            <br />(Overrides <a href="229D566.htm">CrossEntropyContext<span id="LST1C32368C_18" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>EliteSampleDefinition</a>)</td></tr><tr><td><a href="1FE43CBC.htm">InitialParameter</a></td><td>
            Gets the parameter initially exploited to sample from 
            the state-space of the system defined by this context.
            <br />(Inherited from <a href="F04A1B18.htm">CrossEntropyContext</a>)</td></tr><tr><td><a href="CB60FB7E.htm">MaximumNumberOfIterations</a></td><td>
            Gets the maximum number of iterations 
            allowed by this context. 
            </td></tr><tr><td><a href="44E3AF08.htm">MinimumNumberOfIterations</a></td><td>
            Gets the minimum number of iterations 
            required by this context.
            </td></tr><tr><td><a href="847A8F0F.htm">OptimizationGoal</a></td><td>
            Gets a constant specifying if the performance function 
            in this context must be minimized or maximized.
            </td></tr><tr><td><a href="6BFCB280.htm">StateDimension</a></td><td>
            Gets or sets the dimension of a vector representing a 
            system's state
            when 
            a <a href="298402DD.htm">CrossEntropyProgram</a> executes in this
            context.
            <br />(Inherited from <a href="F04A1B18.htm">CrossEntropyContext</a>)</td></tr><tr><td><a href="876F94ED.htm">TraceExecution</a></td><td>
            Gets or sets a value indicating whether the 
            execution of this context must be traced.
            <br />(Inherited from <a href="F04A1B18.htm">CrossEntropyContext</a>)</td></tr></table></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Methods</h2><div id="IDAEASection"><table id="MethodList" class="table is-hoverable"><tr><td><a href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)" target="_blank" rel="noopener noreferrer">Equals</a></td><td>Determines whether the specified object is equal to the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><a href="https://learn.microsoft.com/dotnet/api/system.object.finalize" target="_blank" rel="noopener noreferrer">Finalize</a></td><td>Allows an object to try to free resources and perform other cleanup operations before it is reclaimed by garbage collection.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode" target="_blank" rel="noopener noreferrer">GetHashCode</a></td><td>Serves as the default hash function.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><a href="9B360782.htm">GetOptimalState</a></td><td>
            Gets the argument that optimizes the performance function
            in this context, according to the specified 
            Cross-Entropy sampling parameter.
            </td></tr><tr><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gettype" target="_blank" rel="noopener noreferrer">GetType</a></td><td>Gets the <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a> of the current instance.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><a href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone" target="_blank" rel="noopener noreferrer">MemberwiseClone</a></td><td>Creates a shallow copy of the current <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><a href="E2DFB2BB.htm">OnExecutedIteration</a></td><td>
            Called after completion of each iteration of 
            a <a href="298402DD.htm">CrossEntropyProgram</a> executing in this
            context.
            <br />(Overrides <a href="62A32EE8.htm">CrossEntropyContext<span id="LST1C32368C_19" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>OnExecutedIteration(Int32, DoubleMatrix, LinkedList<span id="LST1C32368C_20" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>Double<span id="LST1C32368C_21" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>, LinkedList<span id="LST1C32368C_22" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>DoubleMatrix<span id="LST1C32368C_23" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>)</a>)</td></tr><tr><td><a href="6D600898.htm">PartialSample</a></td><td>
            Draws the specified subset of a sample from a distribution 
            characterized by the given parameter, using the stated
            random number generator. Used when executing the sampling
            step of a  <a href="298402DD.htm">CrossEntropyProgram</a> running
            in this context.
            <br />(Inherited from <a href="F04A1B18.htm">CrossEntropyContext</a>)</td></tr><tr><td><a href="1AF89526.htm">Performance</a></td><td>
            Defines the performance of a specified state
            in this context.
            <br />(Inherited from <a href="F04A1B18.htm">CrossEntropyContext</a>)</td></tr><tr><td><a href="DB205520.htm">SmoothParameter</a></td><td>
             Provides the smoothing of the updated sampling parameter
             of a <a href="E252E84.htm">SystemPerformanceOptimizer</a>  
             executing in this context.        
             </td></tr><tr><td><a href="F068CBEA.htm">StopAtIntermediateIteration</a></td><td>
            Specifies conditions 
            under which 
            a <a href="E252E84.htm">SystemPerformanceOptimizer</a> executing in 
            this context should be considered as terminated after
            completing an intermediate iteration.
            </td></tr><tr><td><a href="94DC9B0B.htm">StopExecution</a></td><td>
            Specifies conditions 
            under which 
            a <a href="298402DD.htm">CrossEntropyProgram</a> executing in this 
            context should be considered 
            as terminated.
            <br />(Overrides <a href="CFD7B8A4.htm">CrossEntropyContext<span id="LST1C32368C_24" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>StopExecution(Int32, LinkedList<span id="LST1C32368C_25" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>Double<span id="LST1C32368C_26" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>, LinkedList<span id="LST1C32368C_27" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>DoubleMatrix<span id="LST1C32368C_28" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>)</a>)</td></tr><tr><td><a href="https://learn.microsoft.com/dotnet/api/system.object.tostring" target="_blank" rel="noopener noreferrer">ToString</a></td><td>Returns a string that represents the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><a href="CD947DDD.htm">UpdateLevel</a></td><td>
            Updates the performance level for the current iteration 
            of a  <a href="298402DD.htm">CrossEntropyProgram</a> executing in
            this context
            and determines the corresponding elite sample.
            <br />(Overrides <a href="52F57EB0.htm">CrossEntropyContext<span id="LST1C32368C_29" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>UpdateLevel(DoubleMatrix, DoubleMatrix, EliteSampleDefinition, Double, DoubleMatrix<span id="LST1C32368C_30" data-languageSpecificText="cpp=%"></span>)</a>)</td></tr><tr><td><a href="4AE2243.htm">UpdateParameter</a></td><td>
            Updates the 
            sampling parameter attending the generation 
            of the sample in the next iteration of a 
             <a href="298402DD.htm">CrossEntropyProgram</a> executing in 
             this context.
            <br />(Inherited from <a href="F04A1B18.htm">CrossEntropyContext</a>)</td></tr></table></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Bibliography</h2><div id="IDBACCSection"><div><span id="cite1">[1] </span><span class="bibliographyAuthor">Rubinstein, R.Y. and Kroese, D.P.</span>, <span class="bibliographyTitle">The Cross-Entropy Method, A unified Approach to Combinatorial Optimization, Monte-Carlo Simulation, and Machine Learning</span>, <span class="bibliographyPublisher">Springer, New York. (2004)</span></div></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>See Also</h2><div id="seeAlsoSection"><h4>Reference</h4><div><a href="F249DE1E.htm">Novacta.Analytics.Advanced Namespace</a></div></div></div><div id="InThisArticleColumn" class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Definition</a></li><li><a class="quickLink">Remarks</a></li><li><a class="quickLink">Example</a></li><li><a class="quickLink">Constructors</a></li><li><a class="quickLink">Properties</a></li><li><a class="quickLink">Methods</a></li><li><a class="quickLink">Bibliography</a></li><li><a class="quickLink">See Also</a></li></ul></nav></div></div></div><footer id="PageFooter" class="footer border-top py-3 fixedFooter"><div class="columns"><div id="FooterContent" class="column"><p>Copyright (c) Giovanni Lafratta.</p> 
				</div></div></footer></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
hljs.highlightAll();
});</script></body></html>